## 공대형 당구 시뮬레이션
![alt text](/SimulationSoftware/image/danpago-simul.JPG "Simulation")

```
길을 찾아내는 시뮬레이션은 3주에 만들기는 불가능하기에 시중에 나와있는
당구 게임을 당파고와 함께 연동하기로 했다. 그렇다고 해도 여전히 어려운 점이
남아 있는데 당구 게임의 힘과 당파고의 힘이 정확히 같지 않기 때문이다.

따라서 이미 있는 게임을 쓸때 가장 중요했던 것은 게임과 당파고의 캘리브레이션이다.
```
#### 소프트웨어 선정
안드로이드 기반의 '리얼 당구 pro'를 우리의 시뮬레이션 소프트웨어로 선정하였다.
일단 우리가 원하는 지점으로 공을 움직여 볼수 있고 길 찾기 기능이 가능했다.

제대로 된 소프트웨어를 만들려고 하면 상부에 위치한 카메라와 컴퓨터 비젼 (OpenCV 등과 같은) 소프트웨어를 이용해 자동으로 공의 위치를 인식하고 길을 추천해주면 좋았을 것이나 시간 no no.

#### 캘리브레이션 하기
'리얼 당구 pro' 게임을 보면 힘을 조절해서 칠수 있는 부분이 있는데 과연 이 게임의 힘이 50%라고 할때 당파고의 공기 압력은 몇 psi 로 설정을 해야하는가?

게임의 힘이 20%라고 하면 당파고의 공기 압력은 몇 psi로 설정을 해야하는가?

게임에서 당점을 옮겼을 때 실제 당파고는 얼마만크 옮겨서 쳐야하는가?

등에 대한 질문을 답하기 위해서는 게임의 세팅을 변화시켜가면서 당파고의 압력을 기록하면 게임이 추천한 값에 따라 당파고의 압력을 조절해 칠수 있게 된다.

당점도 마찬가지로 게임에서의 당점을 변화시켜가며 당파고를 옮겨가며 쳤을때 얼마만큼 게임과 차이가 나는 지를 보고 게임에 맞춰 세팅을 변경해준다.

이렇게 캘리브레이션을 완료하고 나면 게임이 추천해주는 길과 힘, 당점에 따라 쳤을때 게임처럼 당구를 잘 칠수 있으리라는게 우리의 가정이었다.

#### 프로젝션 맵핑
여담으로.

안드로이드 게임을 당구대에 우리가 원하는 부분만 잘라서 프로젝터로 쏴주기위해 일련의 시스템을 사용하였다.

VJing 소프트웨어 2가지를 사용하였는데 VJing 소프트웨어가 모두 맥용이라 일단 안드로이드 프로그램이 맥에서 돌아갈 수 있도록

1. Bluestacks를 인스톨
2. 로긴하여 리얼당구 pro 깔기
3. 리얼당구 pro 실행
4. Vdmx 를 이용하여 리얼 당구 pro 화면 캡쳐
5. Vdmx 를 이용하여 캡쳐된 화면을 syphon을 이용하여 millumin2로 보내기
6. millumin2에서 마스킹을 하여 불필요한 화면 제거
7. millumin2에서 워핑 툴을 이용하여 당구대 사이즈에 정확히 맞춰 투사

Vdmx와 millumin2는 모두 vjing 프로그램으로 (둘다 유료) 위의 과정들은 모두 실시간으로 이뤄진다.

#### 발전 가능한 부분
1. 카메라 + 컴퓨터 비젼 소프트웨어를 이용한 자동 공 위치 인식 프로그램 만들면 좋을듯. 가장 쉬운 조합은 밝기 고정 가능한 usb 카메라 + openframeworks 로 생각됨.
2. 길찾아주는 소프트웨어.... 이건 시간이 너무 걸릴듯

#### 파일 살펴보기
- image 폴더: 각종 참조 사진 들
- mapping 폴더: 프로젝션 맵핑용 vjing 소프트웨어 프로젝트 파일

#### 사용된 기술들
[공대형 당구 편 Wiki 가서 확인!](https://github.com/gradefree-eng/Billiards/wiki/F%ED%95%99%EC%A0%90-%EA%B3%B5%EB%8C%80%ED%98%95-%EB%8B%B9%EA%B5%AC%ED%8E%B8-%EC%9C%84%ED%82%A4)
